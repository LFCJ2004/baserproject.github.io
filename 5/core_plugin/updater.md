# アップデートスクリプト

baserCMSは、アップデート時にアップデートスクリプトを準備しておくと、そのスクリプトを自動実行する仕組みとなっています。  
アップデートスクリプトは、データベース内のデータの更新、ファイルやフォルダ構造の変更などを行いたい場合に利用します。

## アップデートスクリプトの配置場所

アップデートスクリプト（update.php）は、各プラグイン `config/update/バージョン番号/` というフォルダを作成し、その中に配置します。
バージョン番号は、次にリリースするバージョンとなります。

アップデートスクリプトの配置場所は次のようになります。
```
（例）/plugins/baser-core/config/update/5.1.0/updater.php
```
　

## アップデートメッセージ

アップデート画面に注意事項等のメッセージを表示したい場合は、次のファイルを作成し、配列のキー `updateMessage`
を定義し、メッセージを値として返却します。

```php
//（例）/plugins/baser-core/config/update/5.1.0/config.php
return [
    'updateMessage' = 'アップデートを行う前に files フォルダのバックアップを作成しておいてください。'
];
```

## アップデートログの出力

アップデート時の各処理について、成功可否等のメッセージ表示したい場合は、`BcUpdateLog::set()` を利用します。下記のログファイルにも記録されます。

```
/logs/update.log
```

```php
// メッセージの設定例
BcUpdateLog::set('users のテーブル構造に成功しました。');
```
