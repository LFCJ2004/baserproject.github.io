# ユーティリティ設計書

各種ユーティリティ機能を提供

## ユースケース図
![クラス図：ユーティリティ](../../../svg/use_case/baser-core/utilities.svg)

 
## 機能
### ユーティリティトップを表示する
ユーティリティのトップを表示。

　
### サーバーキャッシュを削除する
`/tmp/cache/` 配下のキャッシュファイルを削除する。

　
### コンテンツ管理のツリー構造をチェックする
コンテンツ管理におけるツリー構造に問題がないかチェックを行う。  
問題があった場合は、`/logs/error.log` にエラー内容を出力する。

　
### コンテンツ管理のツリー構造をリセットする
コンテンツ管理のツリー構造を全てフラットな状態にリセットする。

　
### スペシャルサンクスクレジットを表示する
baserCMSについての貢献者をエンドロール形式で表示する。

　
### 環境情報を表示する
phpinfo と次の情報を表示する
- 設置フォルダ
- データベース
- baserCMSバージョン
- CakePHPバージョン

　
### データメンテナンス
#### バックアップを作成する
CSVファイルとしてZipでバックアップファイルを作成しダウンロードする事ができる。  
baserCMSコアと有効となっているプラグインに関連するテーブルを対象とする。
スキーマファイルは `TableSchema` を継承した、`BcSchema` とし、データに関してはCSVファイルとする。

CakePHPのマイグレーションは、時系列で管理するためのものであり、バックアップとしては扱いづらいので、独自で実装する。
またCakePHPのシーダーについても、データの確認等で扱いづらいのでCSVとする。

#### バックアップからリストアする
上記バックアップファイルよりデータを復元する。

　
### ログメンテナンス
#### ログファイルダウンロード
エラーログファイル等をZipでまとめてダウンロードする事ができる。
#### ログファイル削除
サーバー上のログファイルを全て削除する。

 
## クラス図
### ユーティリティ管理画面
![クラス図：ユーティリティ管理画面](../../../svg/class/baser-core/manage_utilities.svg)

### ユーティリティAPI
![クラス図：ユーティリティAPI](../../../svg/class/baser-core/api_utilities.svg)
　
