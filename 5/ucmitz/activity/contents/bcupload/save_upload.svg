<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2344px" preserveAspectRatio="none" style="width:992px;height:2344px;background:#FFFFFF;" version="1.1" viewBox="0 0 992 2344" width="992px" zoomAndPan="magnify"><defs><filter height="300%" id="f1u1119kfcs470" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="317" cy="20" fill="#000000" filter="url(#f1u1119kfcs470)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><path d="M371.5,54.418 L371.5,62.9844 L351.5,66.9844 L371.5,70.9844 L371.5,79.5508 A0,0 0 0 0 371.5,79.5508 L431.5,79.5508 A0,0 0 0 0 431.5,79.5508 L431.5,64.418 L421.5,54.418 L371.5,54.418 A0,0 0 0 0 371.5,54.418 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M421.5,54.418 L421.5,64.418 L431.5,64.418 L421.5,54.418 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39" x="377.5" y="71.4849">初期化</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="69" x="282.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="49" x="292.5" y="71.1387">initialize</text><path d="M392,95.8203 L392,116.9531 L372,120.9531 L392,124.9531 L392,146.0859 A0,0 0 0 0 392,146.0859 L825,146.0859 A0,0 0 0 0 825,146.0859 L825,105.8203 L815,95.8203 L392,95.8203 A0,0 0 0 0 392,95.8203 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M815,95.8203 L815,105.8203 L825,105.8203 L815,95.8203 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="398" y="112.8872">arrayをstringとして変換し、保存する</text><line style="stroke:#A80036;stroke-width:1.0;" x1="392" x2="825" y1="120.9531" y2="120.9531"/><line style="stroke:#A80036;stroke-width:1.0;" x1="392" x2="825" y1="122.9531" y2="122.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="412" x="398" y="138.02">アップロードのデータをsetUploadedFileに$dataをセットアップする</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="110" x="262" y="103.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="90" x="272" y="125.1074">beforeMarshal</text><rect fill="#FFFFFF" filter="url(#f1u1119kfcs470)" height="282.6055" style="stroke:#000000;stroke-width:2.0;" width="688" x="174" y="156.0859"/><path d="M366,156.0859 L366,165.3828 L356,175.3828 L174,175.3828 " fill="none" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="182" x="177" y="170.0811">新規追加データを設定に反映</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="138" x="248" y="192.3828"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="118" x="258" y="213.5215">setupRequestData</text><path d="M397.5,250.7695 L397.5,259.3359 L377.5,263.3359 L397.5,267.3359 L397.5,275.9023 A0,0 0 0 0 397.5,275.9023 L734.5,275.9023 A0,0 0 0 0 734.5,275.9023 L734.5,260.7695 L724.5,250.7695 L397.5,250.7695 A0,0 0 0 0 397.5,250.7695 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M724.5,250.7695 L724.5,260.7695 L734.5,260.7695 L724.5,250.7695 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="316" x="403.5" y="267.8364">UploadedFileを処理しやすいようにセットアップする</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="121" x="256.5" y="246.3516"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="266.5" y="267.4902">setUploadedFile</text><path d="M419,353.1406 L419,361.707 L399,365.707 L419,369.707 L419,378.2734 A0,0 0 0 0 419,378.2734 L830,378.2734 A0,0 0 0 0 830,378.2734 L830,363.1406 L820,353.1406 L419,353.1406 A0,0 0 0 0 419,353.1406 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M820,353.1406 L820,363.1406 L830,363.1406 L820,353.1406 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="390" x="425" y="370.2075">セッションに保存されたファイルデータをファイルとして保存する</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="164" x="235" y="348.7227"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="144" x="245" y="369.8613">moveFileSessionToTmp</text><polygon fill="#FEFECE" filter="url(#f1u1119kfcs470)" points="196,300.3203,438,300.3203,450,312.3203,438,324.3203,196,324.3203,184,312.3203,196,300.3203" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="321" y="334.5308">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="242" x="196" y="316.1284">セッションに一時ファイルが保存されている場合</text><polygon fill="#FEFECE" filter="url(#f1u1119kfcs470)" points="317,402.6914,329,414.6914,317,426.6914,305,414.6914,317,402.6914" style="stroke:#A80036;stroke-width:1.5;"/><rect fill="#FFFFFF" filter="url(#f1u1119kfcs470)" height="1562.125" style="stroke:#000000;stroke-width:2.0;" width="964" x="11" y="448.6914"/><path d="M77,448.6914 L77,457.9883 L67,467.9883 L11,467.9883 " fill="none" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="14" y="462.6865">保存直前</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="91" x="271.5" y="484.9883"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="71" x="281.5" y="506.127">beforeSave</text><rect fill="#FFFFFF" filter="url(#f1u1119kfcs470)" height="190.2031" style="stroke:#000000;stroke-width:2.0;" width="418" x="239" y="528.957"/><path d="M375,528.957 L375,538.2539 L365,548.2539 L239,548.2539 " fill="none" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="242" y="542.9521">既存ファイルの削除</text><path d="M405,569.6719 L405,578.2383 L385,582.2383 L405,586.2383 L405,594.8047 A0,0 0 0 0 405,594.8047 L647,594.8047 A0,0 0 0 0 647,594.8047 L647,579.6719 L637,569.6719 L405,569.6719 A0,0 0 0 0 405,569.6719 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M637,569.6719 L637,579.6719 L647,579.6719 L637,569.6719 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="411" y="586.7388">既に存在するデータのファイルを捜索</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="136" x="249" y="565.2539"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="116" x="259" y="586.3926">deleteExistingFiles</text><path d="M386,623.6406 L386,632.207 L366,636.207 L386,640.207 L386,648.7734 A0,0 0 0 0 386,648.7734 L563,648.7734 A0,0 0 0 0 563,648.7734 L563,633.6406 L553,623.6406 L386,623.6406 A0,0 0 0 0 386,623.6406 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M553,623.6406 L553,633.6406 L563,633.6406 L553,623.6406 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="392" y="640.7075">画像ファイル群を削除する</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="98" x="268" y="619.2227"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="78" x="278" y="640.3613">cleanupFiles</text><path d="M367,677.6094 L367,686.1758 L347,690.1758 L367,694.1758 L367,702.7422 A0,0 0 0 0 367,702.7422 L505,702.7422 A0,0 0 0 0 505,702.7422 L505,687.6094 L495,677.6094 L367,677.6094 A0,0 0 0 0 367,677.6094 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M495,677.6094 L495,687.6094 L505,687.6094 L495,677.6094 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="373" y="694.6763">ファイルを削除する</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="60" x="287" y="673.1914"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="40" x="297" y="694.3301">delFile</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="122" x="256" y="739.1602"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="102" x="266" y="760.2988">getUploadedFile</text><rect fill="#FFFFFF" filter="url(#f1u1119kfcs470)" height="190.2031" style="stroke:#000000;stroke-width:2.0;" width="437.5" x="221.5" y="783.1289"/><path d="M455.5,783.1289 L455.5,792.4258 L445.5,802.4258 L221.5,802.4258 " fill="none" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="224" x="224.5" y="797.124">削除チェックが入ってるものの削除</text><path d="M381,823.8438 L381,832.4102 L361,836.4102 L381,840.4102 L381,848.9766 A0,0 0 0 0 381,848.9766 L649,848.9766 A0,0 0 0 0 649,848.9766 L649,833.8438 L639,823.8438 L381,823.8438 A0,0 0 0 0 381,823.8438 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M639,823.8438 L639,833.8438 L649,833.8438 L639,823.8438 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="387" y="840.9106">設定ファイルをもとに削除対象かチェック</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="88" x="273" y="819.4258"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="68" x="283" y="840.5645">deleteFiles</text><path d="M422.5,877.8125 L422.5,886.3789 L402.5,890.3789 L422.5,894.3789 L422.5,902.9453 A0,0 0 0 0 422.5,902.9453 L594.5,902.9453 A0,0 0 0 0 594.5,902.9453 L594.5,887.8125 L584.5,877.8125 L422.5,877.8125 A0,0 0 0 0 422.5,877.8125 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M584.5,877.8125 L584.5,887.8125 L594.5,887.8125 L584.5,877.8125 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="428.5" y="894.8794">_deleteの対象をチェック</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="171" x="231.5" y="873.3945"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="151" x="241.5" y="894.5332">deleteFileWhileChecking</text><path d="M367,931.7813 L367,940.3477 L347,944.3477 L367,948.3477 L367,956.9141 A0,0 0 0 0 367,956.9141 L531,956.9141 A0,0 0 0 0 531,956.9141 L531,941.7813 L521,931.7813 L367,931.7813 A0,0 0 0 0 367,931.7813 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M521,931.7813 L521,941.7813 L531,941.7813 L521,931.7813 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="373" y="948.8481">対象ファイルを削除する</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="60" x="287" y="927.3633"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="40" x="297" y="948.502">delFile</text><rect fill="#FFFFFF" filter="url(#f1u1119kfcs470)" height="1015.4844" style="stroke:#000000;stroke-width:2.0;" width="944" x="21" y="983.332"/><path d="M185,983.332 L185,992.6289 L175,1002.6289 L21,1002.6289 " fill="none" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="24" y="997.3271">ファイル作成や移動処理</text><path d="M375.5,1024.0469 L375.5,1032.6133 L355.5,1036.6133 L375.5,1040.6133 L375.5,1049.1797 A0,0 0 0 0 375.5,1049.1797 L526.5,1049.1797 A0,0 0 0 0 526.5,1049.1797 L526.5,1034.0469 L516.5,1024.0469 L375.5,1024.0469 A0,0 0 0 0 375.5,1024.0469 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M516.5,1024.0469 L516.5,1034.0469 L526.5,1034.0469 L516.5,1024.0469 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="381.5" y="1041.1138">ファイル群を保存する</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="77" x="278.5" y="1019.6289"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="57" x="288.5" y="1040.7676">saveFiles</text><path d="M417,1078.0156 L417,1086.582 L397,1090.582 L417,1094.582 L417,1103.1484 A0,0 0 0 0 417,1103.1484 L724,1103.1484 A0,0 0 0 0 724,1103.1484 L724,1088.0156 L714,1078.0156 L417,1078.0156 A0,0 0 0 0 417,1078.0156 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M714,1078.0156 L714,1088.0156 L724,1088.0156 L714,1078.0156 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286" x="423" y="1095.0825">保存対象かチェックしながらファイルを保存する</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="160" x="237" y="1073.5977"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="140" x="247" y="1094.7363">saveFileWhileChecking</text><path d="M408,1131.9844 L408,1140.5508 L388,1144.5508 L408,1148.5508 L408,1157.1172 A0,0 0 0 0 408,1157.1172 L598,1157.1172 A0,0 0 0 0 598,1157.1172 L598,1141.9844 L588,1131.9844 L408,1131.9844 A0,0 0 0 0 408,1131.9844 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M588,1131.9844 L588,1141.9844 L598,1141.9844 L588,1131.9844 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="414" y="1149.0513">一意のファイル名を取得する</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="142" x="246" y="1127.5664"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="122" x="256" y="1148.7051">getUniqueFileName</text><path d="M372,1185.9531 L372,1194.5195 L352,1198.5195 L372,1202.5195 L372,1211.0859 A0,0 0 0 0 372,1211.0859 L536,1211.0859 A0,0 0 0 0 536,1211.0859 L536,1195.9531 L526,1185.9531 L372,1185.9531 A0,0 0 0 0 372,1185.9531 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M526,1185.9531 L526,1195.9531 L536,1195.9531 L526,1185.9531 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="378" y="1203.02">対象ファイルを作成する</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="70" x="282" y="1181.5352"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="50" x="292" y="1202.6738">saveFile</text><path d="M401,1239.9219 L401,1248.4883 L381,1252.4883 L401,1256.4883 L401,1265.0547 A0,0 0 0 0 401,1265.0547 L591,1265.0547 A0,0 0 0 0 591,1265.0547 L591,1249.9219 L581,1239.9219 L401,1239.9219 A0,0 0 0 0 401,1239.9219 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M581,1239.9219 L581,1249.9219 L591,1249.9219 L581,1239.9219 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="407" y="1256.9888">保存用ファイル名を取得する</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="128" x="253" y="1235.5039"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="108" x="263" y="1256.6426">getSaveFileName</text><polygon fill="#FEFECE" filter="url(#f1u1119kfcs470)" points="273.5,1289.4727,360.5,1289.4727,372.5,1301.4727,360.5,1313.4727,273.5,1313.4727,261.5,1301.4727,273.5,1289.4727" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="87" x="273.5" y="1305.2808">tmpIdがある場合</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="33" x="228.5" y="1298.8784">いいえ</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="22" x="372.5" y="1298.8784">はい</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="320" x="33" y="1323.4727"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="300" x="43" y="1344.6113">同名ファイルがあるかを確認しファイル名を変更し返す</text><path d="M529,1323.4727 L529,1344.6055 L509,1348.6055 L529,1352.6055 L529,1373.7383 A0,0 0 0 0 529,1373.7383 L953,1373.7383 A0,0 0 0 0 953,1373.7383 L953,1333.4727 L943,1323.4727 L529,1323.4727 A0,0 0 0 0 529,1323.4727 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M943,1323.4727 L943,1333.4727 L953,1333.4727 L943,1323.4727 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="403" x="535" y="1340.5396">フィールドベースのファイル名でファイルを取得しなければ作成する</text><line style="stroke:#A80036;stroke-width:1.0;" x1="529" x2="953" y1="1348.6055" y2="1348.6055"/><line style="stroke:#A80036;stroke-width:1.0;" x1="529" x2="953" y1="1350.6055" y2="1350.6055"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258" x="535" y="1365.6724">_thumb, _medium, xxxxxx_eyecatchなど</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="136" x="373" y="1331.6211"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="116" x="383" y="1352.7598">getFieldBasename</text><polygon fill="#FEFECE" filter="url(#f1u1119kfcs470)" points="317,1379.7383,329,1391.7383,317,1403.7383,305,1391.7383,317,1379.7383" style="stroke:#A80036;stroke-width:1.5;"/><rect fill="#FFFFFF" filter="url(#f1u1119kfcs470)" height="573.0781" style="stroke:#000000;stroke-width:2.0;" width="567" x="135" y="1413.7383"/><path d="M257,1413.7383 L257,1423.0352 L247,1433.0352 L135,1433.0352 " fill="none" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="138" y="1427.7334">画像の複製や作成</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="121" x="256.5" y="1450.0352"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="266.5" y="1471.1738">setUploadedFile</text><path d="M385.5,1508.4219 L385.5,1516.9883 L365.5,1520.9883 L385.5,1524.9883 L385.5,1533.5547 A0,0 0 0 0 385.5,1533.5547 L662.5,1533.5547 A0,0 0 0 0 662.5,1533.5547 L662.5,1518.4219 L652.5,1508.4219 L385.5,1508.4219 A0,0 0 0 0 385.5,1508.4219 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M652.5,1508.4219 L652.5,1518.4219 L662.5,1518.4219 L652.5,1508.4219 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256" x="391.5" y="1525.4888">画像をExif情報を元に正しい確度に回転する</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="97" x="268.5" y="1504.0039"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="77" x="278.5" y="1525.1426">rotateImage</text><polygon fill="#FEFECE" filter="url(#f1u1119kfcs470)" points="273.5,1557.9727,360.5,1557.9727,372.5,1569.9727,360.5,1581.9727,273.5,1581.9727,261.5,1569.9727,273.5,1557.9727" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="87" x="273.5" y="1573.7808">tmpIdがある場合</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="33" x="228.5" y="1567.3784">いいえ</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="22" x="372.5" y="1567.3784">はい</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="128" x="155" y="1591.9727"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="108" x="165" y="1613.1113">ファイルを作成する</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="224" x="303" y="1591.9727"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="204" x="313" y="1613.1113">セッションにファイル情報を書き込む</text><polygon fill="#FEFECE" filter="url(#f1u1119kfcs470)" points="317,1631.9414,329,1643.9414,317,1655.9414,305,1643.9414,317,1631.9414" style="stroke:#A80036;stroke-width:1.5;"/><path d="M384,1724.3594 L384,1732.9258 L364,1736.9258 L384,1740.9258 L384,1749.4922 A0,0 0 0 0 384,1749.4922 L670,1749.4922 A0,0 0 0 0 670,1749.4922 L670,1734.3594 L660,1724.3594 L384,1724.3594 A0,0 0 0 0 384,1724.3594 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M660,1724.3594 L660,1734.3594 L670,1734.3594 L660,1724.3594 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="265" x="390" y="1741.4263">imagecopy指定の画像をループでコピーする</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="94" x="270" y="1719.9414"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="74" x="280" y="1741.0801">copyImages</text><path d="M388.5,1778.3281 L388.5,1786.8945 L368.5,1790.8945 L388.5,1794.8945 L388.5,1803.4609 A0,0 0 0 0 388.5,1803.4609 L513.5,1803.4609 A0,0 0 0 0 513.5,1803.4609 L513.5,1788.3281 L503.5,1778.3281 L388.5,1778.3281 A0,0 0 0 0 388.5,1778.3281 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M503.5,1778.3281 L503.5,1788.3281 L513.5,1788.3281 L503.5,1778.3281 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="394.5" y="1795.395">画像サイズの取得</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="103" x="265.5" y="1773.9102"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="83" x="275.5" y="1795.0488">getImageSize</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="87" x="273.5" y="1842.8789"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="67" x="283.5" y="1864.0176">copyImage</text><path d="M384,1901.2656 L384,1909.832 L364,1913.832 L384,1917.832 L384,1926.3984 A0,0 0 0 0 384,1926.3984 L561,1926.3984 A0,0 0 0 0 561,1926.3984 L561,1911.2656 L551,1901.2656 L384,1901.2656 A0,0 0 0 0 384,1901.2656 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M551,1901.2656 L551,1911.2656 L561,1911.2656 L551,1901.2656 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="390" y="1918.3325">画像ファイルをコピーする</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="94" x="270" y="1896.8477"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="74" x="280" y="1917.9863">resizeImage</text><polygon fill="#FEFECE" filter="url(#f1u1119kfcs470)" points="273.5,1675.9414,360.5,1675.9414,372.5,1687.9414,360.5,1699.9414,273.5,1699.9414,261.5,1687.9414,273.5,1675.9414" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="87" x="273.5" y="1691.7495">tmpIdがない場合</text><polygon fill="#FEFECE" filter="url(#f1u1119kfcs470)" points="317,1950.8164,329,1962.8164,317,1974.8164,305,1962.8164,317,1950.8164" style="stroke:#A80036;stroke-width:1.5;"/><rect fill="#FFFFFF" filter="url(#f1u1119kfcs470)" height="306.2891" style="stroke:#000000;stroke-width:2.0;" width="675" x="214.5" y="2020.8164"/><path d="M280.5,2020.8164 L280.5,2030.1133 L270.5,2040.1133 L214.5,2040.1133 " fill="none" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="217.5" y="2034.8115">保存直後</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="80" x="277" y="2057.1133"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="60" x="287" y="2078.252">afterSave</text><path d="M429.5,2115.5 L429.5,2124.0664 L409.5,2128.0664 L429.5,2132.0664 L429.5,2140.6328 A0,0 0 0 0 429.5,2140.6328 L879.5,2140.6328 A0,0 0 0 0 879.5,2140.6328 L879.5,2125.5 L869.5,2115.5 L429.5,2115.5 A0,0 0 0 0 429.5,2115.5 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M869.5,2115.5 L869.5,2125.5 L879.5,2125.5 L869.5,2115.5 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="429" x="435.5" y="2132.5669">全フィールドのファイル名をフィールド値ベースのファイル名に変更する</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="185" x="224.5" y="2111.082"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="165" x="234.5" y="2132.2207">renameToBasenameFields</text><path d="M426,2169.4688 L426,2178.0352 L406,2182.0352 L426,2186.0352 L426,2194.6016 A0,0 0 0 0 426,2194.6016 L785,2194.6016 A0,0 0 0 0 785,2194.6016 L785,2179.4688 L775,2169.4688 L426,2169.4688 A0,0 0 0 0 426,2169.4688 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M775,2169.4688 L775,2179.4688 L785,2179.4688 L775,2169.4688 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338" x="432" y="2186.5356">ファイル名をフィールド値ベースのファイル名に変更する</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="178" x="228" y="2165.0508"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="158" x="238" y="2186.1895">renameToBasenameField</text><path d="M405,2210.8711 L405,2232.0039 L385,2236.0039 L405,2240.0039 L405,2261.1367 A0,0 0 0 0 405,2261.1367 L829,2261.1367 A0,0 0 0 0 829,2261.1367 L829,2220.8711 L819,2210.8711 L405,2210.8711 A0,0 0 0 0 405,2210.8711 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M819,2210.8711 L819,2220.8711 L829,2220.8711 L819,2210.8711 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="403" x="411" y="2227.938">フィールドベースのファイル名でファイルを取得しなければ作成する</text><line style="stroke:#A80036;stroke-width:1.0;" x1="405" x2="829" y1="2236.0039" y2="2236.0039"/><line style="stroke:#A80036;stroke-width:1.0;" x1="405" x2="829" y1="2238.0039" y2="2238.0039"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258" x="411" y="2253.0708">_thumb, _medium, xxxxxx_eyecatchなど</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="136" x="249" y="2219.0195"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="116" x="259" y="2240.1582">getFieldBasename</text><path d="M386,2285.5547 L386,2294.1211 L366,2298.1211 L386,2302.1211 L386,2310.6875 A0,0 0 0 0 386,2310.6875 L784,2310.6875 A0,0 0 0 0 784,2310.6875 L784,2295.5547 L774,2285.5547 L386,2285.5547 A0,0 0 0 0 386,2285.5547 " fill="#FBFB77" filter="url(#f1u1119kfcs470)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M774,2285.5547 L774,2295.5547 L784,2295.5547 L774,2285.5547 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="377" x="392" y="2302.6216">ベースファイル名からプレフィックス付のファイル名を取得する</text><rect fill="#FEFECE" filter="url(#f1u1119kfcs470)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="98" x="268" y="2281.1367"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="78" x="278" y="2302.2754">getFileName</text><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="30" y2="50"/><polygon fill="#A80036" points="313,40,317,50,321,40,317,44" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="83.9688" y2="103.9688"/><polygon fill="#A80036" points="313,93.9688,317,103.9688,321,93.9688,317,97.9688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="226.3516" y2="246.3516"/><polygon fill="#A80036" points="313,236.3516,317,246.3516,321,236.3516,317,240.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="324.3203" y2="348.7227"/><polygon fill="#A80036" points="313,338.7227,317,348.7227,321,338.7227,317,342.7227" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="450" x2="840" y1="312.3203" y2="312.3203"/><polygon fill="#A80036" points="836,355.707,840,365.707,844,355.707,840,359.707" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="840" x2="840" y1="312.3203" y2="414.6914"/><line style="stroke:#A80036;stroke-width:1.5;" x1="840" x2="329" y1="414.6914" y2="414.6914"/><polygon fill="#A80036" points="339,410.6914,329,414.6914,339,418.6914,335,414.6914" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="382.6914" y2="402.6914"/><polygon fill="#A80036" points="313,392.6914,317,402.6914,321,392.6914,317,396.6914" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="280.3203" y2="300.3203"/><polygon fill="#A80036" points="313,290.3203,317,300.3203,321,290.3203,317,294.3203" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="137.9375" y2="192.3828"/><polygon fill="#A80036" points="313,182.3828,317,192.3828,321,182.3828,317,186.3828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="599.2227" y2="619.2227"/><polygon fill="#A80036" points="313,609.2227,317,619.2227,321,609.2227,317,613.2227" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="653.1914" y2="673.1914"/><polygon fill="#A80036" points="313,663.1914,317,673.1914,321,663.1914,317,667.1914" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="518.957" y2="565.2539"/><polygon fill="#A80036" points="313,555.2539,317,565.2539,321,555.2539,317,559.2539" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="707.1602" y2="739.1602"/><polygon fill="#A80036" points="313,729.1602,317,739.1602,321,729.1602,317,733.1602" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="853.3945" y2="873.3945"/><polygon fill="#A80036" points="313,863.3945,317,873.3945,321,863.3945,317,867.3945" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="907.3633" y2="927.3633"/><polygon fill="#A80036" points="313,917.3633,317,927.3633,321,917.3633,317,921.3633" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="773.1289" y2="819.4258"/><polygon fill="#A80036" points="313,809.4258,317,819.4258,321,809.4258,317,813.4258" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="1053.5977" y2="1073.5977"/><polygon fill="#A80036" points="313,1063.5977,317,1073.5977,321,1063.5977,317,1067.5977" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="1107.5664" y2="1127.5664"/><polygon fill="#A80036" points="313,1117.5664,317,1127.5664,321,1117.5664,317,1121.5664" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="1161.5352" y2="1181.5352"/><polygon fill="#A80036" points="313,1171.5352,317,1181.5352,321,1171.5352,317,1175.5352" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="1215.5039" y2="1235.5039"/><polygon fill="#A80036" points="313,1225.5039,317,1235.5039,321,1225.5039,317,1229.5039" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="261.5" x2="193" y1="1301.4727" y2="1301.4727"/><line style="stroke:#A80036;stroke-width:1.5;" x1="193" x2="193" y1="1301.4727" y2="1323.4727"/><polygon fill="#A80036" points="189,1313.4727,193,1323.4727,197,1313.4727,193,1317.4727" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="372.5" x2="441" y1="1301.4727" y2="1301.4727"/><line style="stroke:#A80036;stroke-width:1.5;" x1="441" x2="441" y1="1301.4727" y2="1331.6211"/><polygon fill="#A80036" points="437,1321.6211,441,1331.6211,445,1321.6211,441,1325.6211" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="193" x2="193" y1="1357.4414" y2="1391.7383"/><line style="stroke:#A80036;stroke-width:1.5;" x1="193" x2="305" y1="1391.7383" y2="1391.7383"/><polygon fill="#A80036" points="295,1387.7383,305,1391.7383,295,1395.7383,299,1391.7383" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="441" x2="441" y1="1365.5898" y2="1391.7383"/><line style="stroke:#A80036;stroke-width:1.5;" x1="441" x2="329" y1="1391.7383" y2="1391.7383"/><polygon fill="#A80036" points="339,1387.7383,329,1391.7383,339,1395.7383,335,1391.7383" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="1269.4727" y2="1289.4727"/><polygon fill="#A80036" points="313,1279.4727,317,1289.4727,321,1279.4727,317,1283.4727" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="1484.0039" y2="1504.0039"/><polygon fill="#A80036" points="313,1494.0039,317,1504.0039,321,1494.0039,317,1498.0039" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="261.5" x2="219" y1="1569.9727" y2="1569.9727"/><line style="stroke:#A80036;stroke-width:1.5;" x1="219" x2="219" y1="1569.9727" y2="1591.9727"/><polygon fill="#A80036" points="215,1581.9727,219,1591.9727,223,1581.9727,219,1585.9727" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="372.5" x2="415" y1="1569.9727" y2="1569.9727"/><line style="stroke:#A80036;stroke-width:1.5;" x1="415" x2="415" y1="1569.9727" y2="1591.9727"/><polygon fill="#A80036" points="411,1581.9727,415,1591.9727,419,1581.9727,415,1585.9727" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="219" x2="219" y1="1625.9414" y2="1643.9414"/><line style="stroke:#A80036;stroke-width:1.5;" x1="219" x2="305" y1="1643.9414" y2="1643.9414"/><polygon fill="#A80036" points="295,1639.9414,305,1643.9414,295,1647.9414,299,1643.9414" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="415" x2="415" y1="1625.9414" y2="1643.9414"/><line style="stroke:#A80036;stroke-width:1.5;" x1="415" x2="329" y1="1643.9414" y2="1643.9414"/><polygon fill="#A80036" points="339,1639.9414,329,1643.9414,339,1647.9414,335,1643.9414" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="1537.9727" y2="1557.9727"/><polygon fill="#A80036" points="313,1547.9727,317,1557.9727,321,1547.9727,317,1551.9727" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="1753.9102" y2="1773.9102"/><polygon fill="#A80036" points="313,1763.9102,317,1773.9102,321,1763.9102,317,1767.9102" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="1807.8789" y2="1842.8789"/><polygon fill="#A80036" points="313,1832.8789,317,1842.8789,321,1832.8789,317,1836.8789" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="1876.8477" y2="1896.8477"/><polygon fill="#A80036" points="313,1886.8477,317,1896.8477,321,1886.8477,317,1890.8477" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="1699.9414" y2="1719.9414"/><polygon fill="#A80036" points="313,1709.9414,317,1719.9414,321,1709.9414,317,1713.9414" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="372.5" x2="680" y1="1687.9414" y2="1687.9414"/><polygon fill="#A80036" points="676,1815.3789,680,1825.3789,684,1815.3789,680,1819.3789" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="680" x2="680" y1="1687.9414" y2="1962.8164"/><line style="stroke:#A80036;stroke-width:1.5;" x1="680" x2="329" y1="1962.8164" y2="1962.8164"/><polygon fill="#A80036" points="339,1958.8164,329,1962.8164,339,1966.8164,335,1962.8164" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="1930.8164" y2="1950.8164"/><polygon fill="#A80036" points="313,1940.8164,317,1950.8164,321,1940.8164,317,1944.8164" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="1655.9414" y2="1675.9414"/><polygon fill="#A80036" points="313,1665.9414,317,1675.9414,321,1665.9414,317,1669.9414" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="1403.7383" y2="1450.0352"/><polygon fill="#A80036" points="313,1440.0352,317,1450.0352,321,1440.0352,317,1444.0352" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="961.332" y2="1019.6289"/><polygon fill="#A80036" points="313,1009.6289,317,1019.6289,321,1009.6289,317,1013.6289" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="426.6914" y2="484.9883"/><polygon fill="#A80036" points="313,474.9883,317,484.9883,321,474.9883,317,478.9883" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="2091.082" y2="2111.082"/><polygon fill="#A80036" points="313,2101.082,317,2111.082,321,2101.082,317,2105.082" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="2145.0508" y2="2165.0508"/><polygon fill="#A80036" points="313,2155.0508,317,2165.0508,321,2155.0508,317,2159.0508" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="2199.0195" y2="2219.0195"/><polygon fill="#A80036" points="313,2209.0195,317,2219.0195,321,2209.0195,317,2213.0195" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="2252.9883" y2="2281.1367"/><polygon fill="#A80036" points="313,2271.1367,317,2281.1367,321,2271.1367,317,2275.1367" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317" x2="317" y1="1974.8164" y2="2057.1133"/><polygon fill="#A80036" points="313,2047.1133,317,2057.1133,321,2047.1133,317,2051.1133" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[0713df7f5515140c698dee1c2249f8ea]
@startuml

start
:initialize;
note right
    初期化
end note
:beforeMarshal;
note right
    arrayをstringとして変換し、保存する
    ====
    アップロードのデータをsetUploadedFileに$dataをセットアップする
end note
group 新規追加データを設定に反映
:setupRequestData;
:setUploadedFile;
note right
    UploadedFileを処理しやすいようにセットアップする
end note
if (セッションに一時ファイルが保存されている場合) then (yes)
    :moveFileSessionToTmp;
    note right
    セッションに保存されたファイルデータをファイルとして保存する
    end note
endif
end group
group 保存直前
:beforeSave;
group 既存ファイルの削除
:deleteExistingFiles;
note right
    既に存在するデータのファイルを捜索
end note
:cleanupFiles;
note right
    画像ファイル群を削除する
end note
:delFile;
note right
    ファイルを削除する
end note
end group
:getUploadedFile;
group 削除チェックが入ってるものの削除
:deleteFiles;
note right
    設定ファイルをもとに削除対象かチェック
end note
:deleteFileWhileChecking;
note right
    _deleteの対象をチェック
end note
:delFile;
note right
    対象ファイルを削除する
end note
end group
group ファイル作成や移動処理
:saveFiles;
note right
    ファイル群を保存する
end note
:saveFileWhileChecking;
note right
    保存対象かチェックしながらファイルを保存する
end note
:getUniqueFileName;
note right
    一意のファイル名を取得する
end note
:saveFile;
note right
    対象ファイルを作成する
end note
:getSaveFileName;
note right
    保存用ファイル名を取得する
end note
if (tmpIdがある場合) then (いいえ)
    :同名ファイルがあるかを確認しファイル名を変更し返す;
else (はい)
    :getFieldBasename;
    note right
        フィールドベースのファイル名でファイルを取得しなければ作成する
        ====
        _thumb, _medium, xxxxxx_eyecatchなど
    end note
endif
group 画像の複製や作成
:setUploadedFile;
:rotateImage;
note right
    画像をExif情報を元に正しい確度に回転する
end note
if (tmpIdがある場合) then (いいえ)
    :ファイルを作成する;
else (はい)
    :セッションにファイル情報を書き込む;
endif
if (tmpIdがない場合)
    :copyImages;
    note right
        imagecopy指定の画像をループでコピーする
    end note
    :getImageSize;
    note right
        画像サイズの取得
    end note
    :copyImage;
    :resizeImage;
    note right
        画像ファイルをコピーする
    end note
endif
end group
end group
end group
group 保存直後
:afterSave;
:renameToBasenameFields;
note right
    全フィールドのファイル名をフィールド値ベースのファイル名に変更する
end note
:renameToBasenameField;
note right
    ファイル名をフィールド値ベースのファイル名に変更する
end note
:getFieldBasename;
note right
    フィールドベースのファイル名でファイルを取得しなければ作成する
    ====
    _thumb, _medium, xxxxxx_eyecatchなど
end note
:getFileName;
    note right
        ベースファイル名からプレフィックス付のファイル名を取得する
    end note
end group
@enduml

PlantUML version 1.2021.14(Sat Nov 13 00:46:50 CST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>